<header class="flex justify-center items-center bg-primary text-white h-14">
  <div class="flex justify-between w-full max-w-5xl p-2">
    <h1 class="w-1/3 font-bold text-3xl"><a routerLink="/">FILMO</a></h1>
    <nav class="flex justify-center items-center max-w-2/3 gap-4">
      <div class="relative">
        <input
          class="h-7 text-sm text-primary pl-4 bg-secondary rounded-2xl focus:outline-none focus:bg-white"
          [(ngModel)]="searchTerm"
          (keyup.enter)="onSearch()"
          spellcheck="false"
        />
        <button
          class="absolute top-0.5 right-2.5 text-primary hover:cursor-pointer"
          (click)="onSearch()"
        >
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
      </div>
      <a
        class="hover:text-secondary"
        *ngIf="!isLoggedIn"
        routerLink="/login"
        routerLinkActive="active"
        >Iniciar sesión</a
      >
      <div *ngIf="user$ | async as user">
        <a
          *ngIf="isLoggedIn"
          class="hover:cursor-pointer hover:text-secondary"
          routerLink="/user/profile/{{ user.username }}"
          >Perfil</a
        >
      </div>
      <div *ngIf="isLoggedIn">
        <p *ngIf="notifications.length < 1">{{ notifications.length }}</p>
        <button *ngIf="notifications.length > 0" (click)="openRecsDialog()">
          {{ notifications.length }}
        </button>
      </div>
      <button
        *ngIf="isLoggedIn"
        class="hover:cursor-pointer hover:text-secondary"
        (click)="logout()"
      >
        Cerrar sesión
      </button>
    </nav>
  </div>
</header>
<dialog
  #notifsDialogRef
  class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-6 rounded shadow max-w-md w-full"
>
  <button (click)="closeRecsDialog()">
    <i class="fa-solid fa-xmark"></i>
  </button>
  <ul *ngFor="let noti of notifications">
    <li>
      {{ noti.recommender_username }} te ha recomendado ver
      <a routerLink="/movie/{{ noti.movie_id }}" (click)="closeRecsDialog()">{{
        noti.movie_title
      }}</a>
      <button
        class="hover:cursor-pointer"
        (click)="deleteNotification(noti.id)"
      >
        &nbsp;eliminar
      </button>
    </li>
  </ul>
</dialog>
